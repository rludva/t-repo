schemaVersion: 2.2.2
metadata:
  name: my-sample-devfile
  version: 1.0.0
  description: "A sample devfile to demonstrate ConfigMap mounting"

volumes:
  - name: config-volume
    configMap:
      name: my-configmap  

components:
  - name: config-volume
    kubernetes:
      inlined: |
        apiVersion: v1
        kind: ConfigMap
        metadata:
          name: my-configmap
        data:
          my-config-file.conf: |
            key1=value1
            key2=value2

  - name: my-container
    container:
      image: my-sample-image:latest
      memoryLimit: 512Mi
      mountSources: true
      volumeMounts:
        - name: config-volume
          path: /etc/config
      endpoints:
        - name: http-8080
          targetPort: 8080
          
commands:
  - id: build
    exec:
      component: my-container
      commandLine: "mvn clean install"
      workingDir: /projects/my-app
      group:
        kind: build
        isDefault: true

  - id: run
    exec:
      component: my-container
      commandLine: "java -jar /projects/my-app/target/my-app.jar"
      workingDir: /projects/my-app
      group:
        kind: run
        isDefault: true
